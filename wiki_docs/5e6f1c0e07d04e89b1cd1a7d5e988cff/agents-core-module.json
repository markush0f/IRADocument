{
  "id": "agents-core-module",
  "title": "Agents Core",
  "description": "Documentation for the Agents Core module, detailing its files and functionalities.",
  "content_markdown": "# Agents Core Module Reference\n\n## Overview\nThe Agents Core module provides the foundational components and tools for managing agents and their interactions within a project.\n\n## Files Analysis\n\n### File: app/core/database.py\n- **Database Configuration**: Configures an asynchronous SQLite database connection using `create_async_engine`, leveraging `DATABASE_URL` to support async operations.\n- **Dependency Injection**: Implements the `get_session` async generator function for providing `AsyncSession` instances, ensuring proper session lifecycle management in asynchronous contexts.\n\n### File: app/agents/tools/relation_tools.py\n- **Project Relations**: Contains utility functions for managing architectural relations within a project, including:\n  - `register_relation`\n  - `list_project_relations`\n  - Leveraging `RelationService` for database interactions.\n\n### File: app/agents/core/factory.py\n- **Client Management**: Defines the `LLMFactory` class for creating and returning specific LLM clients such as `OllamaClient`, abstracting the client creation process based on provider configurations.\n\n### File: app/agents/core/ollama_client.py\n- **Integration**: Implements the `OllamaClient`, extending `BaseLLMClient` to interact with the Ollama API using `ollama.AsyncClient` for response generation and chat processing.\n- **Error Handling**: Logs errors encountered during API interactions using a logger initialized via `get_logger`, aiding in debugging and monitoring.\n- **Configuration**: Initializes `host` and `model` properties from `settings.ollama_base_url` and `settings.ollama_model`, facilitating runtime configurability of parameters for the Ollama API client.\n\n### File: app/agents/core/pipeline.py\n- **Control Flow**: Defines the `BasePipeline` class for managing a sequential flow of analysis stages, utilizing an injected `AgentExecutor` to process prompts and maintain results across stages.\n- **Tool Management**: Allows dynamic adjustment of tools available for each execution stage based on the `tools` parameter, enabling flexibility during pipeline executions.\n\n### File: app/agents/discovery_pipeline.py\n- **Dynamic Stage Execution**: Implements the `ProjectDiscoveryPipeline`, executing various analysis stages in sequence while dynamically handling context preparation and utilizing `TechnologyScanner` for automated technology stack detection.\n\n## Dependencies\n- The module interacts with:\n  - `AsyncSessionLocal` from `database.py` for session management.\n  - `RelationService` in `relation_tools.py` for database operations related to project relations.\n  - `AgentExecutor` in `pipeline.py` for managing prompt processing and stage results.\n  - `ollama.AsyncClient` and `BaseLLMClient` within `ollama_client.py` for communication with the Ollama API.",
  "diagram_mermaid": null,
  "related_files": [
    "app/core/database.py",
    "app/agents/tools/relation_tools.py",
    "app/agents/core/factory.py",
    "app/agents/core/ollama_client.py",
    "app/agents/core/pipeline.py",
    "app/agents/discovery_pipeline.py"
  ]
}