{
  "id": "tools-module",
  "title": "Agent Tools",
  "description": "Detailed reference documentation for the Agent Tools module, including file analysis, key functionalities, and dependencies.",
  "content_markdown": "## Overview\nThis module contains various tools for managing projects, files, relations, facts, and analysis within an agent architecture, facilitating efficient interactions and data management.\n\n## File: registry.py\n- **Tool Management**: Implements a `ToolRegistry` class to manage tool definitions such as functions registered via the `tool` decorator, storing them with JSON schema definitions for type safety and documentation.\n- **Schema Generation**: Uses Pydantic's `create_model` method to dynamically create models for generating JSON schemas, ensuring automatic serialization and validation of function parameters based on type hints.\n- **Logging**: Integrates a logging system to monitor actions such as the registration of tools with the `get_logger` function, creating a logger specific to the module.\n- **Singleton Pattern**: Constructs a singleton instance of `ToolRegistry` called `registry` for easy global access throughout the application.\n\n## File: project_tools.py\n- **Project Management**: Defines asynchronous functions like `create_project`, `list_projects`, and `get_project_details` using `ProjectService`, responsible for database interactions in project records.\n- **Database Interaction**: Utilizes the `AsyncSessionLocal` context manager to handle database sessions asynchronously, ensuring proper management in concurrent environments.\n- **Error Handling**: Includes error handling in `get_project_details` to return an error message if a project ID is not found.\n\n## File: file_tools.py\n- **File Management**: Implements asynchronous tools such as `register_file`, `list_project_files`, and `read_file_content` to manage file registrations and operations with `FileService` for database interactions.\n- **Database Interaction**: Uses `AsyncSessionLocal` for managing database sessions asynchronously during file operations.\n- **File Handling**: Employs the `aiofiles` library for non-blocking I/O in `read_file_content`, allowing efficient file reads without blocking the event loop.\n- **Security**: Implements access checks in `list_directory_content` to ensure paths accessed remain within project root, preventing unauthorized file access.\n- **Error Handling**: Includes error handling in functions to return messages for common issues like file not found or access denied, aiding in debugging.\n\n## File: relation_tools.py\n- **Relation Management**: Provides asynchronous functions `register_relation` and `list_project_relations` to manage architectural relationships, using `RelationService` for database interactions.\n- **Database Interaction**: Ensures correct retrieval and creation of relation records through the `AsyncSessionLocal` context manager.\n- **Data Handling**: Constructs output in `list_project_relations` to return relationships, detailing `from`, `to`, and `type`, aiding project architecture insights.\n\n## File: fact_tools.py\n- **Fact Management**: Defines asynchronous functions `register_fact` and `list_project_facts` for managing facts related to a project, using `FactService` for database interactions.\n- **Data Handling**: Constructs a payload for new facts in `register_fact` and parses JSON format in `list_project_facts` to return structured results with key fields like ID, type, source, and confidence.\n- **Database Interaction**: Uses `AsyncSessionLocal` to manage database connections efficiently during fact operations.\n- **Error Handling**: Includes structured error handling in `list_project_facts`, returning responses with important fields in case of errors.\n\n## File: analysis_tools.py\n- **Analysis Functionality**: Defines asynchronous tools, `analyze_tech_stack` and `browse_repository`, using `AgentExecutor` to execute tasks requiring specific tools identified by names.\n- **Dependencies**: Makes substantial use of imports such as `LLMFactory` for language model clients and `PromptLoader` for loading analysis prompts, indicating a modular approach.\n- **Configuration**: Loads language model client settings from `app.core.config`, allowing for flexible configuration based on external environment settings.\n- **Prompt Management**: Dynamically loads user prompts from the filesystem via `PromptLoader`, supporting contextual customization based on project ID.\n\n## Dependencies\n- **Agent Executor** from `agent_executor.py` is utilized for executing agents.\n- **AsyncSessionLocal** provides database session management across multiple files (project_tools.py, file_tools.py, relation_tools.py, and fact_tools.py).\n- **Pydantic** is heavily used for data modeling and schema validation across various tools.",
  "diagram_mermaid": null,
  "related_files": [
    "registry.py",
    "project_tools.py",
    "file_tools.py",
    "relation_tools.py",
    "fact_tools.py",
    "analysis_tools.py"
  ]
}