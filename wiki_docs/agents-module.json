{
  "id": "agents-module",
  "title": "Agents",
  "description": "Detailed reference documentation for the Agents module, outlining files, functionalities, and dependencies.",
  "content_markdown": "## Overview\nThis module provides tools and agents for managing projects, files, facts, relations, and analysis within a structured pipeline architecture in an application.\n\n## Files Analysis\n\n### File: `registry.py`\n- **Purpose**: Implements a `ToolRegistry` class for managing tool definitions and ensuring type safety through JSON schema definitions.\n- **Key Classes/Functions**:\n  - `ToolRegistry`: Manages tool registrations and interaction with the application.\n  - `get_logger`: Initializes logging specific to the module.\n  - Singleton pattern implemented for global access via the `registry` instance.\n\n### File: `project_tools.py`\n- **Purpose**: Defines asynchronous functions for managing project life cycles.\n- **Key Functions**:\n  - `create_project`, `list_projects`, `get_project_details`: Functions interact with the `ProjectService` for database operations and manage project data asynchronously.\n  - Utilizes `AsyncSessionLocal` for database session management and includes error handling in `get_project_details` for project lookups.\n\n### File: `file_tools.py`\n- **Purpose**: Implements tools for file management, including registration and content reading.\n- **Key Functions**:\n  - `register_file`, `list_project_files`, `read_file_content`, `list_directory_content`: These functions manage file operations and ensure security and session management via `AsyncSessionLocal` and `aiofiles`.\n  - Enhanced error handling for file operations to provide detailed feedback on common issues.\n\n### File: `relation_tools.py`\n- **Purpose**: Provides functions for managing relationships between project components.\n- **Key Functions**:\n  - `register_relation`, `list_project_relations`: Manages relation data capture and retrieval, using `RelationService` for database interactions and handling outputs.\n\n### File: `fact_tools.py`\n- **Purpose**: Manages project-related facts and their storage/retrieval.\n- **Key Functions**:\n  - `register_fact`, `list_project_facts`: These functions utilize `FactService` for asynchronous database operations while providing data handling and error feedback.\n\n### File: `analysis_tools.py`\n- **Purpose**: Defines analysis tools for project structures and stacks.\n- **Key Functions**:\n  - `analyze_tech_stack`, `browse_repository`: Utilize `AgentExecutor` for executing analysis tasks and loading prompts dynamically based on the project ID.\n- **Dependencies**: Requires imports from `app.core.config` and uses components like `LLMFactory` and `PromptLoader`.\n\n### File: `agent.py`\n- **Purpose**: Implements the `MinerAgent` class for file analysis and structured conclusion extraction.\n- **Key Classes/Functions**:\n  - `MinerAgent`: Utilizes `AgentExecutor` for handling user messages and tool registration.\n  - Asynchronous methods: `analyze_file`, `analyze_batch` for processing analysis tasks with error handling and batch processing logic.\n\n### File: `schema.py`\n- **Purpose**: Defines data models using Pydantic to validate analysis results.\n- **Key Classes/Functions**:\n  - `MinerConclusion`, `MinerOutput`, `MinerBatchOutput`: Structured models ensuring data integrity and clear documentation with field descriptions.\n\n### File: `prompts.py`\n- **Purpose**: Establishes the main prompt for the Miner agent's role and guidelines for data extraction.\n- **Key Features**:\n  - `MINER_SYSTEM_PROMPT`: Provides a basis for the agent's tasks, ensuring clear and objective procedures for information extraction.\n\n### File: `discovery_pipeline.py`\n- **Purpose**: Manages project discovery stages and their execution order.\n- **Key Features**:\n  - Uses `TechnologyScanner` for tech stack analysis and ensures prompt accuracy during each analysis stage.\n\n### File: `agent_executor.py`\n- **Purpose**: Handles dynamic execution of tools via `AgentExecutor`.\n- **Key Features**:\n  - Manages message histories and error logging, maintaining continuity across agent tasks and providing insights into failures.\n\n### File: `types.py`\n- **Purpose**: Defines type aliases for analysis stages to ensure clear constraints on stages used in analysis.\n\n### File: `prompt_loader.py`\n- **Purpose**: Handles loading prompts from text files with robust error handling for file retrieval.\n\n### File: `factory.py`\n- **Purpose**: Implements a factory method for creating instances of LLM clients based on configuration settings.\n\n### File: `base.py`\n- **Purpose**: Defines an abstract base class for LLM client interactions, enforcing interface adherence for derived classes.\n\n### File: `ollama_client.py`\n- **Purpose**: Implements a specific LLM client with configuration and message processing capabilities using async operations.\n\n### File: `pipeline.py`\n- **Purpose**: Manages analysis pipelines, controlling the execution flow and aggregating results from various analysis stages.\n\n### File: `openai_client.py`\n- **Purpose**: Integrates with OpenAI's API for generating and processing interactions, emphasizing asynchronous capabilities for improved performance.\n\n## Dependencies\nThe `app/agents` module communicates with various other modules depending on file-specific interactions:\n- **`app.core.config`**: For configuration settings, particularly in LLM and prompt management.\n- **`Pydantic`**: For data validation and model creation.\n- **`aiofiles`**: For non-blocking file I/O operations.\n- **`AgentExecutor`** and tools from `app/agents` for orchestration of functionalities across modules.\n- **Database Services**: Customized services (e.g., `ProjectService`, `FileService`, `FactService`, `RelationService`) integrated for CRUD operations with an asynchronous context manager.",
  "diagram_mermaid": null,
  "related_files": []
}